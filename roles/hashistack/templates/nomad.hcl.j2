# Managed by jamlab-ansible
datacenter = "dc1"
data_dir = "/opt/nomad"

{% if hashistack is defined %}
    {%- if hashistack == 'server' %}
        {%- include 'nomad_server.hcl.j2' %}
    {%- elif hashistack == 'client' %}
        {%- include 'nomad_client.hcl.j2' %}
    {% endif %}
{% endif %}

telemetry {
  prometheus_metrics         = true
  disable_hostname           = true
  publish_allocation_metrics = true
  publish_node_metrics       = true
}

consul {
  address             = "127.0.0.1:8501"
  ssl                 = true
  ca_file             = "/etc/consul.d/consul-agent-ca.pem"
  cert_file           = "/etc/consul.d/dc1-cli-consul-0.pem"
  key_file            = "/etc/consul.d/dc1-cli-consul-0-key.pem"
  server_service_name = "nomad"
  client_service_name = "nomad-client"
  auto_advertise      = true
  server_auto_join    = true
  client_auto_join    = true
}
