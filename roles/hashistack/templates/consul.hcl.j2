# Managed by jamlab-ansible
datacenter = "dc1"
data_dir = "/opt/consul"
encrypt = "{{ consul_gossip_key }}"

{% if hashistack is defined %}
    {%- if hashistack == 'server' %}
        {%- include 'consul_server.hcl.j2' %}
    {%- elif hashistack == 'client' %}
        {%- include 'consul_client.hcl.j2' %}
    {% endif %}
{% endif %}


ports {
  grpc = 8502
}

connect {
  enabled = true
}

retry_join = ["vb0.jamfox.dev", "vb1.jamfox.dev", "vb2.jamfox.dev"]

bind_addr = "{{ ansible_eth0.ipv4.address }}"

acl {
  enabled = true
  default_policy = "allow"
  enable_token_persistence = true
}

performance {
  raft_multiplier = 1
}

telemetry {
  prometheus_retention_time = "480h"
  disable_hostname          = true
}
